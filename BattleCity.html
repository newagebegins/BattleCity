<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
  "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <title>Battle City</title>
  
  <script type="text/javascript" src="lib/jquery-1.7.2.js"></script>

  <script type="text/javascript" src="src/Utils.js"></script>
  <script type="text/javascript" src="src/Point.js"></script>
  <script type="text/javascript" src="src/Rect.js"></script>
  <script type="text/javascript" src="src/Sprite.js"></script>
  <script type="text/javascript" src="src/Tank.js"></script>
  <script type="text/javascript" src="src/Wall.js"></script>
  <script type="text/javascript" src="src/SpriteContainer.js"></script>
  <script type="text/javascript" src="src/CollisionDetector.js"></script>
  <script type="text/javascript" src="src/EventManager.js"></script>
  <script type="text/javascript" src="src/TankController.js"></script>
  <script type="text/javascript" src="src/Keyboard.js"></script>
  <script type="text/javascript" src="src/BulletFactory.js"></script>
  <script type="text/javascript" src="src/Bullet.js"></script>
  <script type="text/javascript" src="src/Painter.js"></script>
  <script type="text/javascript" src="src/Updater.js"></script>
  
  <script type="text/javascript" src="lib/Stats.js"></script>
  <script type="text/javascript" src="src/FPSCounter.js"></script>
  
  <script type="text/javascript" src="src/ImageManager.js"></script>

  <script type="text/javascript">
    $(function () {
      var FPS = 24;
      var fpsCounter = new FPSCounter();
      
      var CANVAS_ID = 'canvas';
      var CANVAS_WIDTH = 640;
      var CANVAS_HEIGHT = 480;
      var ctx = createCanvasContext();
      
      var eventManager = new EventManager();
      var keyboard = new Keyboard(eventManager);
      var painter = new Painter(eventManager);
      var updater = new Updater(eventManager);
      var bounds = new Rect(0, 0, CANVAS_WIDTH, CANVAS_HEIGHT);
      var collisionDetector = new CollisionDetector(eventManager, bounds);
      
      var tank = new Tank(eventManager);
      tank.setRect(0, 0, 26, 26);
      tank.setNormalSpeed(4);
      tank.setBulletSize(4);
      tank.setBulletSpeed(2);
      
      var tankController = new TankController(eventManager, tank);
      var bulletFactory = new BulletFactory(eventManager);
      
      var wall = new Wall(eventManager);
      wall.setRect(50, 50, 32, 32);
      
      setInterval(gameLoop, 1000 / FPS);
      
      function gameLoop() {
        fpsCounter.begin();
        
        keyboard.fireEvents();
        updater.update();
        
        clearCanvas();
        painter.draw(ctx);
        
        fpsCounter.end();
      }
      
      function createCanvasContext() {
        $('<canvas id="' + CANVAS_ID + '" width="' + CANVAS_WIDTH + '" height="' + CANVAS_HEIGHT + '"></canvas>').appendTo('body');
        var canvas = document.getElementById(CANVAS_ID);
        return canvas.getContext('2d');
      };
      
      function clearCanvas() {
        ctx.fillStyle = "black";
        ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
      };
    });
  </script>

</head>

<body>
</body>
</html>
